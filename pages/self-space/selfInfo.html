<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>人人售电-掌上电力交易平台</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <link rel="stylesheet" href="../../assets/css/weuix.min.css">
    <link rel="stylesheet" href="../../assets/css/common.css">
    <script src="../../assets/js/zepto.min.js"></script>
    <script src="../../assets/js/lib/picker.js"></script>
    <script src="../../assets/js/lib/select.js"></script>
    <script src="../../assets/js/lib/picker-city.js"></script>
    <style>
    .weui_uploader_input_wrp:before {
        width: 2px;
        height: 20px;
    }

    .weui_uploader_input_wrp:after {
        width: 20px;
        height: 2px;
    }

    .weui_uploader_input_wrp:before,
    .weui_uploader_input_wrp:after {
        top: 65%;
    }
    </style>
</head>

<body ontouchstart style="background-color: #f8f8f8;">
    <div class="weui_btn_primary weui-header ">
        <div class="weui-header-left">
            <a href="javascript:history.back();" class="icon icon-109 f-white"></a>
        </div>
        <h1 class="weui-header-title">个人资料</h1>
    </div>
    <!--     <div class="weui_panel weui_panel_access">
        <div class="weui_panel_bd">
            <a href="javascript:;" class="weui_media_box weui_media_appmsg">
                <div class="weui_media_bd left">
                    <h4 class="weui_media_title">头像</h4>
                </div>
                <div class="weui_media_hd right" style="margin-right: 0">
                    <img class="weui_media_appmsg_thumb img-radius" src="images/tx.png" alt="">
                </div>
            </a>
        </div>
    </div> -->
    <form id="form">
        <div class="weui_panel">
            <div class="weui_panel_bd">
                <div class="weui_media_box weui_media_small_appmsg">
                    <div class="weui_cells weui_cells_access">
                        <a class="weui_cell weui-flex" href="javascript:;">
                            <div class="weui-flex-item">姓名<span class="f-red rel" style="top:4px;left: 10px;">*</span></div>
                            <div class="weui-flex-item tright">
                                <input type="text" required emptyTips="姓名不能为空" class="weui_input tright f-gray f15" value="陈昌明">
                            </div>
                        </a>
                        <a class="weui_cell weui-flex" href="javascript:;">
                            <div class="weui-flex-item">角色<span class="f-red rel" style="top:4px;left: 10px;">*</span></div>
                            <div class="weui-flex-item tright">
                                <input id="role" type="text" class="weui_input tright f-gray f15" value="售电经纪人">
                            </div>
                        </a>
                        <a class="weui_cell weui-flex" href="javascript:;">
                            <div class="weui-flex-item">联系方式<span class="f-red rel" style="top:4px;left: 10px;">*</span></div>
                            <div class="weui-flex-item tright">
                                <input class="weui_input tright f-gray f15" type="text" required pattern="^1[3|4|5|8][0-9]\d{8}$" placeholder="填写常用号码" emptyTips="手机号码不能为空" tips="手机号码格式不正确" value="15108533071">
                            </div>
                        </a>
                        <a class="weui_cell weui-flex" href="javascript:;" id="sex">
                            <div class="weui-flex-item">性别</div>
                            <div class="weui-flex-item tright f-gray f15" id="sexVal">男</div>
                        </a>
                        <a class="weui_cell weui-flex" href="javascript:;" id="bir">
                            <div class="weui-flex-item">出生日期</div>
                            <div class="weui-flex-item tright">
                                <input type="text" id="birVal" class="weui_input tright f-gray f15" value="1991-12-11">
                            </div>
                        </a>
                        <a class="weui_cell weui-flex" href="javascript:;">
                            <div class="weui-flex-item">所属单位</div>
                            <div class="weui-flex-item tright">
                                <input type="text" class="weui_input tright f-gray f15" placeholder="手动输入">
                            </div>
                        </a>
                        <!--                         <a class="weui_cell weui-flex" href="javascript:;">
                            <div class="weui-flex-item">年龄</div>
                            <div class="weui-flex-item tright f-gray f15" id="ageVal">27</div>
                        </a> -->
                        <a class="weui_cell weui-flex" href="javascript:;">
                            <div class="weui-flex-item">所属区域</div>
                            <div class="weui-flex-item tright">
                                <input id="location" type="text" class="weui_input tright f-gray f15">
                            </div>
                        </a>
                        <div class="weui_cell">
                            <div class="weui_cell_bd weui_cell_primary">
                                <div class="weui_uploader">
                                    <div class="weui_uploader_hd weui_cell">
                                        <div class="weui_cell_bd weui_cell_primary">请上传头像、身份证正面和反面照片<span class="f-red rel" style="top:4px;left: 10px;">*</span></div>
                                    </div>
                                    <div class="weui_uploader_bd">
                                        <ul class="weui_uploader_files" id='img2x'>
                                        </ul>
                                        <div class="weui_uploader_input_wrp">
                                            <p class="tcenter f13 f-gray" style="margin-top: 15px;">个人头像</p>
                                            <input class="weui_uploader_input" type="file" accept="image/jpg,image/jpeg,image/png,image/gif" onchange="previewImage(this)" />
                                        </div>
                                        <div class="weui_uploader_input_wrp">
                                            <p class="tcenter f13 f-gray" style="margin-top: 15px;">身份证正面</p>
                                            <input class="weui_uploader_input" type="file" accept="image/jpg,image/jpeg,image/png,image/gif" onchange="previewImage(this)" />
                                        </div>
                                        <div class="weui_uploader_input_wrp">
                                            <p class="tcenter f13 f-gray" style="margin-top: 15px;">身份证反面</p>
                                            <input class="weui_uploader_input" type="file" accept="image/jpg,image/jpeg,image/png,image/gif" onchange="previewImage(this)" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="weui_btn_area mb-20">
            <a class="weui_btn weui_btn_primary bg-green" type="submit" id="formSubmitBtn">确认提交</a>
        </div>
    </form>
    <div class="weui-footer m-t25">
        <p class="weui-footer-links">
            <a href="javascript:;" class="weui-footer-link">百电集团</a>
        </p>
        <p class="weui-footer__text">Copyright &copy; 2017-2020</p>
    </div>
    <script>
    // 预览上传图片
    function previewImage(file) {
        var MAXWIDTH = 100;
        var MAXHEIGHT = 200;
        // 循环
        for (var i = 0; i < file.files.length; i++) {
            if (file.files && file.files[i]) {
                var reader = new FileReader();
                reader.onload = function(evt) {
                    file.parentNode.setAttribute('style', 'display:none');
                    $('#img2x').append('<li class="weui_uploader_file" style="background-image:url(' + evt.target.result + ')"></li>');
                };
                reader.readAsDataURL(file.files[i]);
            }
        }
    }


    $(function() {

        // 角色
        $("#role").select({
            title: "请选择角色",
            autoClose: true,
            items: ['售电经纪人', '售电公司'],
            onChange: function(d) {
                $('#role').html(d.values);
            }
        });

        // 性别
        $("#sex").select({
            title: "请选择性别",
            autoClose: true,
            items: ['男', '女'],
            onChange: function(d) {
                $('#sexVal').html(d.values);
            }
        });

        // 选择区域
        $("#location").cityPicker({
            title: "选择省市",
            showDistrict: false
        });

        // 出生日期及年龄
        birAge();
        $("#birVal").change(function() {
            birAge();
        });

        function birAge() {
            var date = new Date();
            var year = date.getFullYear();
            var month = (date.getMonth() + 1) < 10 ? "0" + (date.getMonth() + 1) : (date.getMonth() + 1);
            var day = date.getDate();
            // 出生日期
            $("#birVal").datetimePicker({
                title: "选择出生日期",
                m: 1,
                min: '1916-01-01',
                max: (year + 1) + "-" + month + "-" + day
            });
            // 年龄
            var birYear = $("#birVal").val().split('-')[0];
            var age = year - birYear;
            $('#ageVal').html(age);
        };

        // 表单验证
        var $form = $("#form");
        $form.form();

        $("#formSubmitBtn").on("click", function() {
            $form.validate(function(error) {
                if (error) {
                    console.log(error.msg)
                } else {
                    $("#formSubmitBtn").addClass('weui_btn_disabled');
                    $.showLoading();
                    setTimeout(function() {
                        $.hideLoading();
                        $.toast("操作成功");
                        $("#formSubmitBtn").removeClass('weui_btn_disabled');
                    }, 1000)
                }
            });

        });
    })
    </script>
</body>

</html>
